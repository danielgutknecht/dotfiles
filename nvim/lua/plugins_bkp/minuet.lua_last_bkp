-- ~/.config/nvim/lua/plugins/minuet.lua
-- lazyvim: https://www.lazyvim.org, https://github.com/LazyVim/LazyVim
return {
  -- Minuet AI
  {
    "milanglacier/minuet-ai.nvim",
    dependencies = {
      "saghen/blink.cmp",
      "nvim-lua/plenary.nvim",
      "nvim-mini/mini.snippets", -- nome atualizado
    },
    event = "InsertEnter",
    opts = function()
      return {
        provider = "codestral", -- ou "claude", "gemini", "codestral"
        -- openai = {
        --   api_key = vim.env.OPENAI_API_KEY or "sk-...",
        --   model = "gpt-4o-mini",
        -- },
        virtualtext = {
          auto_trigger_ft = {
            "lua",
            "python",
            "javascript",
            "typescript",
            "javascriptreact",
            "typescriptreact",
            "rust",
            "go",
          },
          min_prefix_length = 3,
          debounce_ms = 300,
          max_tokens = 512,
          keymap = {
            accept = "<A-L>",
            accept_line = "<A-l>",
            prev = "<A-[>",
            next = "<A-]>",
            dismiss = "<A-h>",
          },
        },
        notify = "warn",
        request_timeout = 10,
      }
    end,
    config = function(_, opts)
      require("minuet").setup(opts)
    end,
  },

  -- Blink.cmp
  {
    "saghen/blink.cmp",
    version = "*",
    event = "InsertEnter",
    opts = {
      keymap = {
        preset = "default",
        ["<C-Space>"] = { "show", "show_documentation", "hide_documentation" },
        ["<C-e>"] = { "hide" },
        ["<CR>"] = { "accept", "fallback" },
        ["<C-k>"] = { "select_prev", "fallback" },
        ["<C-j>"] = { "select_next", "fallback" },
        ["<Up>"] = { "select_prev", "fallback" },
        ["<Down>"] = { "select_next", "fallback" },
        ["<C-b>"] = { "scroll_documentation_up", "fallback" },
        ["<C-f>"] = { "scroll_documentation_down", "fallback" },
      },

      appearance = {
        use_nvim_cmp_as_default = true,
        nerd_font_variant = "mono",
      },

      completion = {
        accept = {
          auto_brackets = { enabled = true },
        },
      },
    },
  },
}
